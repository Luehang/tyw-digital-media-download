<div class="home-screen">
    <div class="rela-block top-section" style="min-width:375px;">
        <div class="abs-center top-text">
            <h2>TYW Digital Media</h2>
            <p style="color:#fff">Where Talent Meets your Production.</p>
            <a href="{{APP_URL}}" style="text-decoration:none;color:#1abc9c;">
                <div class="rela-inline rect-button top-button"><p>Learn More<br>TYW</p></div>
            </a>
        </div>
        <div class="bottom-arrow"></div>
    </div>
</div>

<div class="primary-container clearfix">
    <div class="main-wrapper">
        {{#if mainProduct }}
        {{#each mainProduct }}
        <div class="block">
            <div class="front-product main-visual">
                {{#if this.video_url }}
                    <iframe class="video-player" src="{{this.video_url}}" frameborder="0" allow="autoplay; encrypted-media" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
                {{else }}
                    <img src="{{this.image_path}}"/>
                {{/if }}
                <div class="buttons">
                    <a class="buy" href="/products/{{this._id}}">More Info.</a>
                </div>
            </div>
            
            <div class="info main-info" style="display:flex;flex-direction:column;">
                <a href="/products/{{this._id}}" style="text-decoration:none;"><h4>{{this.title}}</h4></a>
                <span class="description">{{this.description}}</span>
                <div>
                    <span class="full-price price">${{this.price}}</span>
                    <a class="button" style="width: 120px;margin: 0;float: right;" href="/checkout/{{this._id}}">Buy Now</a>
                </div>
            </div>
            
            <div class="details">
                <span class="time">{{this.created_at}}</span>
                <a href="/products/{{this._id}}">
                    <div class="star-ratings-sprite" style="float: right;">
                        <span style="width: {{this.percent_rating}}%" class="star-ratings-sprite-rating"></span>
                    </div>
                </a>
            </div>
        </div>
        {{/each }}
        {{/if }}

        <div class="sort-row">
            {{#each products }}
            <div class="sort block">
                <div class="front-product">
                    <img src="{{this.image_path}}"/>
                    <div class="buttons">
                        <a class="buy" href="/products/{{this._id}}">More Info.</a>
                    </div>
                </div>
                
                <div class="info">
                    <a href="/products/{{this._id}}" style="text-decoration:none;"><h4>{{this.title}}</h4></a>
                    <span class="description">{{this.description}}</span>
                    <div>
                        <span class="full-price price">${{this.price}}</span>
                        <a class="button" style="width: 120px;margin: 0;float: right;" href="/checkout/{{this._id}}">Buy Now</a>
                    </div>
                </div>
                
                <div class="details">
                    <span class="time">{{this.created_at}}</span>
                    <a href="/products/{{this._id}}">
                        <div class="star-ratings-sprite" style="float: right;">
                            <span style="width: {{this.percent_rating}}%" class="star-ratings-sprite-rating"></span>
                        </div>
                    </a>
                </div>
            </div>
            {{/each }}
        </div>
    </div>
</div>

<script>
    $(window).scroll(function(){
        var top_height = $('.top-section').innerHeight(),
            scroll_pos = $(window).scrollTop(),
            difference = top_height + scroll_pos,
            new_top = difference/2,
            opacity_mod = (scroll_pos / top_height) * 0.4, // Decimal controls rate of opacity change
            opacity_val = (top_height - scroll_pos)/top_height - opacity_mod;
        
        if(scroll_pos <= top_height ) {
            $('.top-text').css('top', new_top);
            $('.top-text').css('opacity', opacity_val);
            $('.bottom-arrow').css('opacity', opacity_val*1.2);
        }
        
        (scroll_pos >= (top_height - 100)) ? ( $('.nav-bar').addClass('scrolled') ) : ( $('.nav-bar').removeClass('scrolled') );
        
    });
</script>

