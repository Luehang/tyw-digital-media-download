"use strict";function starRating(a){var e=[5,4.5,4,3.5,3,2.5,2,1.5,1,.5],t=null,l=null,n=null,r=null;a=Number.parseFloat(a);for(var s=0;s<e.length;s++){if(a>e[s]){r=e[s];break}if(a===e[s]){l=e[s];break}}if(l)return l;if(r){if(t=r+.5,n=r+.25,a>=n)return t;if(a<n)return r}}function htmlRating(a){for(var e=[5,4,3,2,1],t="",l="",n='<div class="rating">',r=0;r<e.length;r++)a===e[r]&&(t="checked"),a===e[r]-.5&&(l="checked"),n+="<input "+t+' type="radio" id="star'+e[r]+'" disabled />\n                    <label class = "full" for="star'+e[r]+'"></label>',n+="<input "+l+' type="radio" id="star'+(e[r]-.5)+'" disabled />\n                    <label class = "half" for="star'+(e[r]-.5)+'"></label>',t="",l="";return n+"</div>"}function getRateHTML(a){return htmlRating(starRating(a))}function getStarRating(a){return'<form class="rating" style="width: 138px;">'+(5===a?'<input checked type="radio" id="star5" name="rating" value="5" disabled />\n                <label class = "full" for="star5"></label>':'<input type="radio" id="star5" name="rating" value="5" disabled />\n                <label class = "full" for="star5"></label>')+(4===a?'<input checked type="radio" id="star4" name="rating" value="4" disabled />\n                <label class = "full" for="star4"></label>':'<input type="radio" id="star4" name="rating" value="4" disabled />\n                <label class = "full" for="star4"></label>')+(3===a?'<input checked type="radio" id="star3" name="rating" value="3" disabled />\n                <label class = "full" for="star3"></label>':'<input type="radio" id="star3" name="rating" value="3" disabled />\n                <label class = "full" for="star3"></label>')+(2===a?'<input checked type="radio" id="star2" name="rating" value="2" disabled />\n                <label class = "full" for="star2"></label>':'<input type="radio" id="star2" name="rating" value="2" disabled />\n                <label class = "full" for="star2"></label>')+(1===a?'<input checked type="radio" id="star1" name="rating" value="1" disabled />\n                <label class = "full" for="star1"></label>':'<input type="radio" id="star1" name="rating" value="1" disabled />\n                <label class = "full" for="star1"></label>')+"</form>"}function returnDateTime(a){var e=new Date(a),t=e.getHours(),l=e.getMinutes().toString(),n=e.getMonth()+1,r=e.getDate(),s=e.getFullYear();return 1===l.length&&(l="0"+l),t>=13?n+"/"+r+"/"+s+" at "+(t-=12)+":"+l+" PM":0===t?n+"/"+r+"/"+s+" at "+(t=12)+":"+l+" AM":n+"/"+r+"/"+s+" at "+t+":"+l+" AM"}function stopLoader(){$(".loader").fadeOut("slow",function(){$(".comments .inner").fadeIn("slow")})}var defaultAvatar="/img/default-avatar.svg",guestusername="",productID=$("#product-id").val(),url="/api/review-message/"+productID,allComments=[],productRatingDiv=$("#product-rating-div"),productRating=$("#product-rating").val(),productRatingHTML=getRateHTML(productRating);productRatingDiv.html(productRatingHTML),$.ajax({type:"GET",url:url,dataType:"json",contentType:"application/json",cache:!0}).done(function(a){if(a.success){allComments=a.data;var e=0;$.each(allComments,function(a,t){var l=$('<div class="comment"></div>');$('<img class="avatar" alt="avatar" src="'+defaultAvatar+'"/>').appendTo(l);var n=$('<div class="body"></div>');$('<a target="_blank">'+this.name+"</a>").appendTo(n),$("<span> • "+returnDateTime(this.created_at)+"</span><br />"+getStarRating(this.rating)+"<br />").appendTo(n),$("<p>"+this.message+"</p>").appendTo(n),n.appendTo(l),l.appendTo(".comments .inner"),e++}),e==allComments.length&&stopLoader()}a.success||stopLoader()}),setTimeout(function(){stopLoader()},1e4),$(function(){var a=null;$(".stars-container .click").click(function(){a=$(this).val(),a=Number.parseInt(a)}),$(".send-msg").click(function(){var e=$(".your-name").val(),t=$(".your-msg").val(),l=[],n="",r=$("#front-annotation"),s=$("#alert"),i=$('<div class="comment" style="display: none;"></div>'),d=$('<div class="body"></div>');if(null===a&&l.push("Invalid rating."),""===e&&l.push("Name field needs to be filled out."),(""===t||t.length<=10)&&l.push("Message needs to be longer than 10 characters."),0!==l.length)l.map(function(a){n+='<p style="color: red;">* '+a+"</p>"}),s.html(n),r.css("display","block");else{$.ajax({type:"POST",url:url,data:{userId:"GUEST",name:e,rating:a,message:t},dataType:"json",cache:!0}).done(function(a){a.success&&(s.html('<p style="color: green;">Review posted successfully.</p>'),r.css("display","block"))});var o=returnDateTime((new Date).toISOString()),u=getStarRating(a);$(".your-msg").val(""),$(".your-name").fadeOut().remove(),$(".your-msg").before('<div class="input your-name dived">'+e+"</div>"),$('<img class="avatar" alt="avatar" src="'+defaultAvatar+'" />').appendTo(i),$('<a target="_blank">'+e+"</a>").appendTo(d),$("<span> • "+o+"</span><br />"+u+"<br />").appendTo(d),$("<p>"+t+"</p>").appendTo(d),d.appendTo(i),$(".add-new").after(i),i.fadeIn("slow")}})});